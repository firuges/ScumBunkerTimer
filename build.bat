@echo off
chcp 65001 >nul 2>&1
setlocal enabledelayedexpansion

:: ===========================================
::   SCUM Bot V2 - Build Generator Completo
:: ===========================================
title SCUM Bot V2 - Build Generator
color 0B

echo ========================================
echo   SCUM Bot V2 - Build Generator
echo ========================================
echo.
echo   Genera una carpeta portable completa
echo   Con TODOS los sistemas integrados
echo.
echo ========================================

:: Cambiar al directorio del script
cd /d "%~dp0"

:: Verificar archivos esenciales
echo.
echo üìÑ Verificando archivos esenciales...

if not exist "BunkerAdvice_V2.py" (
    color 0C
    echo ‚ùå ERROR: No se encuentra BunkerAdvice_V2.py
    pause
    exit /b 1
)

if not exist "requirements.txt" (
    color 0C
    echo ‚ùå ERROR: No se encuentra requirements.txt
    pause
    exit /b 1
)

echo ‚úÖ Archivos esenciales verificados

:: Definir directorio de build
set "BUILD_DIR=build"
set "BUILD_TIMESTAMP=%date:~10,4%%date:~4,2%%date:~7,2%_%time:~0,2%%time:~3,2%%time:~6,2%"
set "BUILD_TIMESTAMP=%BUILD_TIMESTAMP: =0%"
set "BUILD_FULL_DIR=%BUILD_DIR%\ScumBot_Complete_%BUILD_TIMESTAMP%"

:: Crear directorio de build
echo.
echo üìÅ Creando directorio de build...
if exist "%BUILD_DIR%" (
    echo    Limpiando build anterior...
    rmdir /s /q "%BUILD_DIR%" >nul 2>&1
)

mkdir "%BUILD_FULL_DIR%"
mkdir "%BUILD_FULL_DIR%\logs"
mkdir "%BUILD_FULL_DIR%\backup"
mkdir "%BUILD_FULL_DIR%\config"
mkdir "%BUILD_FULL_DIR%\scripts"
mkdir "%BUILD_FULL_DIR%\docs"
mkdir "%BUILD_FULL_DIR%\databases"

echo ‚úÖ Directorio creado: %BUILD_FULL_DIR%

:: ===========================================
::   COPIAR ARCHIVOS PRINCIPALES
:: ===========================================
echo.
echo üìÑ Copiando archivos principales del bot...

:: Archivo principal
copy "BunkerAdvice_V2.py" "%BUILD_FULL_DIR%\" >nul 2>&1

:: Sistemas principales
copy "database_v2.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "bot_status_system.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "bot_starter.py" "%BUILD_FULL_DIR%\" >nul 2>&1

:: Sistema de servidores
copy "server_monitor.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "server_database.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "server_commands.py" "%BUILD_FULL_DIR%\" >nul 2>&1

echo ‚úÖ Archivos principales copiados

:: ===========================================
::   MODULO CORE REFACTORIZADO (NUEVO)
:: ===========================================
echo.
echo üîß Copiando m√≥dulo core refactorizado...

:: Crear directorio core
mkdir "%BUILD_FULL_DIR%\core" >nul 2>&1

copy "core\__init__.py" "%BUILD_FULL_DIR%\core\" >nul 2>&1
copy "core\user_manager.py" "%BUILD_FULL_DIR%\core\" >nul 2>&1

echo ‚úÖ M√≥dulo core copiado (sistema de usuarios centralizado)

:: ===========================================
::   SISTEMA DE TAXI COMPLETO
:: ===========================================
echo.
echo üöñ Copiando sistema de taxi completo...

copy "taxi_system.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "taxi_database.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "taxi_admin.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "taxi_config.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "banking_system.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "welcome_system.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "translation_manager.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "migrate_taxi_db.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "migrate_mechanic_db.py" "%BUILD_FULL_DIR%\" >nul 2>&1

echo ‚úÖ Sistema de taxi copiado

:: ===========================================
::   SISTEMA DE MECANICO
:: ===========================================
echo.
echo üîß Copiando sistema de mec√°nico...

copy "mechanic_system.py" "%BUILD_FULL_DIR%\" >nul 2>&1

echo ‚úÖ Sistema de mec√°nico copiado

:: ===========================================
::   SISTEMA PREMIUM
:: ===========================================
echo.
echo üíé Copiando sistema premium...

copy "premium_commands.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "premium_exclusive_commands.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "premium_utils.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "subscription_manager.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "shop_config.py" "%BUILD_FULL_DIR%\" >nul 2>&1

echo ‚úÖ Sistema premium copiado

:: ===========================================
::   SISTEMA DE RATE LIMITING Y ESCALABILIDAD
:: ===========================================
echo.
echo ‚ö° Copiando sistema de rate limiting y escalabilidad...

copy "rate_limiter.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "rate_limit_admin.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "database_pool.py" "%BUILD_FULL_DIR%\" >nul 2>&1

echo ‚úÖ Sistema de rate limiting copiado

:: ===========================================
::   SISTEMA DE ALERTAS
:: ===========================================
echo.
echo üîî Copiando sistema de alertas...

copy "reset_alerts_admin.py" "%BUILD_FULL_DIR%\" >nul 2>&1

echo ‚úÖ Sistema de alertas copiado

::  ===========================================
::   UTILIDADES Y HERRAMIENTAS
:: ===========================================
echo.
echo üõ†Ô∏è Copiando utilidades...

copy "economic_calculator.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "economic_optimization.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "verify_optimization.py" "%BUILD_FULL_DIR%\" >nul 2>&1

:: Herramientas de testing (opcionales pero √∫tiles)
copy "test_taxi_system.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "test_database_fix.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "debug_user.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "check_db.py" "%BUILD_FULL_DIR%\" >nul 2>&1

:: Scripts de prueba para rate limiting y escalabilidad
copy "test_rate_limiting.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "test_bot_integration.py" "%BUILD_FULL_DIR%\" >nul 2>&1

:: Scripts de migraci√≥n cr√≠ticos
copy "migrate_system_tables.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "migrate_user_languages.py" "%BUILD_FULL_DIR%\" >nul 2>&1

:: ===========================================
::   TESTS DE CORRECCIONES CR√çTICAS (NUEVO)
:: ===========================================
echo.
echo üß™ Copiando tests de correcciones cr√≠ticas...

:: Tests de correcciones de botones
copy "test_button_fixes.py" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "test_architecture_fix.py" "%BUILD_FULL_DIR%\" >nul 2>&1

echo ‚úÖ Tests de correcciones copiados

:: Archivos esenciales
copy "requirements.txt" "%BUILD_FULL_DIR%\" >nul 2>&1

echo ‚úÖ Utilidades copiadas

:: ===========================================
::   SCRIPTS DE INSTALACION
:: ===========================================
echo.
echo üì¶ Copiando scripts de instalaci√≥n...

copy "scripts\install_windows_simple.bat" "%BUILD_FULL_DIR%\scripts\" >nul 2>&1
copy "scripts\install_windows_fixed.bat" "%BUILD_FULL_DIR%\scripts\" >nul 2>&1
copy "scripts\install_windows_debug.bat" "%BUILD_FULL_DIR%\scripts\" >nul 2>&1
copy "scripts\cleanup.bat" "%BUILD_FULL_DIR%\scripts\" >nul 2>&1

echo ‚úÖ Scripts de instalaci√≥n copiados

:: ===========================================
::   SISTEMA DE TRADUCCIONES
:: ===========================================
echo.
echo üåç Copiando archivos de traducciones...

:: Crear carpeta de traducciones
if not exist "%BUILD_FULL_DIR%\translations" mkdir "%BUILD_FULL_DIR%\translations" >nul 2>&1

:: Copiar archivos de traducciones
copy "translations\*.json" "%BUILD_FULL_DIR%\translations\" >nul 2>&1

echo ‚úÖ Sistema de traducciones copiado

:: ===========================================
::   DOCUMENTACION COMPLETA
:: ===========================================
echo.
echo üìö Copiando documentaci√≥n completa...

:: Documentaci√≥n principal
copy "README.md" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "TAXI_SYSTEM_README.md" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "TAXI_SYSTEM_FINAL.md" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "MECHANIC_SYSTEM_GUIDE.md" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "MECHANIC_SYSTEM_CHANGELOG.md" "%BUILD_FULL_DIR%\" >nul 2>&1

:: Documentaci√≥n en carpeta docs
copy "docs\COMANDOS_GUIA.md" "%BUILD_FULL_DIR%\docs\" >nul 2>&1
copy "docs\DEPLOY_GUIDE.md" "%BUILD_FULL_DIR%\docs\" >nul 2>&1
copy "docs\PYTHON_3.13_SOLUCION.md" "%BUILD_FULL_DIR%\docs\" >nul 2>&1
copy "docs\WINDOWS_DEPLOY.md" "%BUILD_FULL_DIR%\docs\" >nul 2>&1
copy "docs\WINDOWS_INSTALL_FIX.md" "%BUILD_FULL_DIR%\docs\" >nul 2>&1
copy "docs\TAXI_TUTORIAL.html" "%BUILD_FULL_DIR%\docs\" >nul 2>&1
copy "docs\BOT_STATUS_GUIDE.md" "%BUILD_FULL_DIR%\docs\" >nul 2>&1
copy "docs\PREMIUM_SYSTEM_DOCS.md" "%BUILD_FULL_DIR%\docs\" >nul 2>&1
copy "docs\MULTIPLE_SERVERS_GUIDE.md" "%BUILD_FULL_DIR%\docs\" >nul 2>&1

:: Documentaci√≥n de correcciones cr√≠ticas (NUEVO)
copy "BOTONES_CORREGIDOS.md" "%BUILD_FULL_DIR%\docs\" >nul 2>&1

:: Archivos HTML
copy "guide.html" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "bot_presentation.html" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "bot_presentation_multilang.html" "%BUILD_FULL_DIR%\" >nul 2>&1
copy "bot_presentation.py" "%BUILD_FULL_DIR%\" >nul 2>&1

echo ‚úÖ Documentaci√≥n copiada

:: ===========================================
::   BASES DE DATOS EXISTENTES
:: ===========================================
echo.
echo üóÑÔ∏è Copiando bases de datos existentes...

:: Verificar y copiar bases de datos si existen
set "DB_COUNT=0"

:: bunkers_v2.db ya no se usa directamente - datos migrados a scum_main.db
if exist "bunkers_v2.db" (
    echo    ‚ö†Ô∏è  bunkers_v2.db - LEGACY (datos en scum_main.db)
) else if exist "legacy_backups\bunkers_v2.db" (
    echo    ‚úÖ bunkers_v2.db - Movida a legacy_backups (datos en scum_main.db)
)

if exist "scum_main.db" (
    copy "scum_main.db" "%BUILD_FULL_DIR%\databases\" >nul 2>&1
    echo    ‚úÖ scum_main.db - Base principal unificada (taxi+bank+usuarios)
    set /a DB_COUNT+=1
)

:: Mantener compatibilidad con bases antiguas si existen
if exist "taxi_system.db" (
    if not exist "scum_main.db" (
        copy "taxi_system.db" "%BUILD_FULL_DIR%\databases\" >nul 2>&1
        echo    ‚ö†Ô∏è  taxi_system.db - Base antigua (migrar a scum_main.db)
        set /a DB_COUNT+=1
    )
)

:: scum_bank.db ya no se usa - datos migrados a scum_main.db
if exist "scum_bank.db" (
    echo    ‚ö†Ô∏è  scum_bank.db - LEGACY (datos migrados a scum_main.db)
) else if exist "legacy_backups\scum_bank.db" (
    echo    ‚úÖ scum_bank.db - Movida a legacy_backups (datos en scum_main.db)
)

if exist "subscriptions.db" (
    copy "subscriptions.db" "%BUILD_FULL_DIR%\databases\" >nul 2>&1
    echo    ‚úÖ subscriptions.db - Sistema premium
    set /a DB_COUNT+=1
)

:: Buscar otras bases de datos .db
for %%f in (*.db) do (
    if not "%%f"=="scum_main.db" (
        if not "%%f"=="taxi_system.db" (
            if not "%%f"=="subscriptions.db" (
                copy "%%f" "%BUILD_FULL_DIR%\databases\" >nul 2>&1
                echo    ‚úÖ %%f - Base de datos adicional
                set /a DB_COUNT+=1
            )
        )
    )
)

if !DB_COUNT! gtr 0 (
    echo ‚úÖ !DB_COUNT! base(s) de datos copiada(s)
    echo    üìÅ Ubicaci√≥n: databases\
    echo    üí° Estas BD contienen datos reales del servidor
) else (
    echo ‚ö†Ô∏è No se encontraron bases de datos existentes
    echo    üí° El bot crear√° nuevas BD autom√°ticamente
)

:: ===========================================
::   CONFIGURACION AUTOMATICA
:: ===========================================
echo.
echo ‚öôÔ∏è Creando configuraci√≥n autom√°tica...

:: Leer token del .env si existe
set "DISCORD_TOKEN_VALUE="
if exist ".env" (
    for /f "usebackq delims=" %%i in (`powershell -command "if (Test-Path '.env') { (Get-Content '.env' | Where-Object { $_ -match '^DISCORD_TOKEN=' }) -replace 'DISCORD_TOKEN=', '' }"`) do (
        set "DISCORD_TOKEN_VALUE=%%i"
    )
)

:: Crear config.py completo
if defined DISCORD_TOKEN_VALUE (
    echo # Configuraci√≥n completa del SCUM Bot > "%BUILD_FULL_DIR%\config.py"
    call echo DISCORD_TOKEN = '%%DISCORD_TOKEN_VALUE%%' >> "%BUILD_FULL_DIR%\config.py"
    echo ‚úÖ Token configurado autom√°ticamente desde .env
) else (
    echo # Configuraci√≥n completa del SCUM Bot > "%BUILD_FULL_DIR%\config.py"
    echo DISCORD_TOKEN = 'TU_TOKEN_AQUI' >> "%BUILD_FULL_DIR%\config.py"
    echo ‚ö†Ô∏è Token requiere configuraci√≥n manual
)

:: Configuraci√≥n completa
echo. >> "%BUILD_FULL_DIR%\config.py"
echo # Administraci√≥n del bot >> "%BUILD_FULL_DIR%\config.py"
echo BOT_CREATOR_ID = 418198613210955776 >> "%BUILD_FULL_DIR%\config.py"
echo BOT_ADMIN_IDS = [418198613210955776] >> "%BUILD_FULL_DIR%\config.py"
echo PREFIX = '/' >> "%BUILD_FULL_DIR%\config.py"
echo DEBUG = True >> "%BUILD_FULL_DIR%\config.py"
echo. >> "%BUILD_FULL_DIR%\config.py"
echo # Base de datos >> "%BUILD_FULL_DIR%\config.py"
echo DATABASE_NAME = 'scum_main.db' >> "%BUILD_FULL_DIR%\config.py"
echo TAXI_DATABASE_NAME = 'scum_main.db' >> "%BUILD_FULL_DIR%\config.py"
echo. >> "%BUILD_FULL_DIR%\config.py"
echo # Configuraci√≥n de logs >> "%BUILD_FULL_DIR%\config.py"
echo LOG_LEVEL = 'INFO' >> "%BUILD_FULL_DIR%\config.py"
echo LOG_FILE = 'logs/bot.log' >> "%BUILD_FULL_DIR%\config.py"
echo. >> "%BUILD_FULL_DIR%\config.py"
echo # Sistemas habilitados >> "%BUILD_FULL_DIR%\config.py"
echo TAXI_SYSTEM_ENABLED = True >> "%BUILD_FULL_DIR%\config.py"
echo PREMIUM_SYSTEM_ENABLED = True >> "%BUILD_FULL_DIR%\config.py"
echo MECHANIC_SYSTEM_ENABLED = True >> "%BUILD_FULL_DIR%\config.py"
echo SERVER_MONITOR_ENABLED = True >> "%BUILD_FULL_DIR%\config.py"
echo RATE_LIMITING_ENABLED = True >> "%BUILD_FULL_DIR%\config.py"
echo DATABASE_POOL_ENABLED = True >> "%BUILD_FULL_DIR%\config.py"

echo ‚úÖ config.py creado con configuraci√≥n completa

:: ===========================================
::   CREAR INSTALADOR PRINCIPAL
:: ===========================================
echo.
echo üì¶ Creando instalador principal...

echo @echo off > "%BUILD_FULL_DIR%\INSTALL.bat"
echo chcp 65001 ^>nul 2^>^&1 >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo setlocal enabledelayedexpansion >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo title SCUM Bot V2 - Instalador Completo >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo color 0A >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo ======================================== >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo   SCUM Bot V2 - Instalador Completo >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo ======================================== >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo   Sistema completo con 10 subsistemas: >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo   ^üè† Bunkers ^üöñ Taxi ^üè¶ Bancario ^üîß Mec√°nico ^üèÜ Escuadrones >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo   ^üìä Monitoreo ^üíé Premium ^üîî Alertas ^‚öôÔ∏è Admin ^‚ö° Rate Limiting >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo ======================================== >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo cd /d "%%~dp0" >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo üìÑ Verificando archivos del sistema... >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo if not exist "requirements.txt" ^( >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     color 0C >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     echo ‚ùå ERROR: Archivos del sistema incompletos >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     pause >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     exit /b 1 >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo ^) >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo ‚úÖ Archivos del sistema verificados >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo üêç Verificando Python... >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo python --version ^>nul 2^>^&1 >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo if errorlevel 1 ^( >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     color 0C >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     echo ‚ùå Python no est√° instalado >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     echo    Descarga Python desde: https://python.org >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     echo    Marca "Add to PATH" durante la instalaci√≥n >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     pause >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     exit /b 1 >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo ^) >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo ‚úÖ Python encontrado: >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo python --version >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo üì¶ Instalando dependencias completas... >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo pip install --user -r requirements.txt >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo if errorlevel 1 ^( >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     color 0C >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     echo ‚ùå Error instalando dependencias >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     echo    Intenta ejecutar: scripts\install_windows_debug.bat >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     pause >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo     exit /b 1 >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo ^) >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo ‚úÖ Dependencias instaladas correctamente >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo ========================================== >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo   üéâ INSTALACI√ìN COMPLETADA >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo ========================================== >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo üìã PR√ìXIMOS PASOS: >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
if defined DISCORD_TOKEN_VALUE (
    echo echo ‚úÖ 1. Token ya configurado autom√°ticamente >> "%BUILD_FULL_DIR%\INSTALL.bat"
    echo echo üóÑÔ∏è 2. Migrar base de datos: python migrate_system_tables.py >> "%BUILD_FULL_DIR%\INSTALL.bat"
    echo echo üöÄ 3. Ejecutar: start_bot.bat >> "%BUILD_FULL_DIR%\INSTALL.bat"
) else (
    echo echo üìù 1. Editar config.py con tu token >> "%BUILD_FULL_DIR%\INSTALL.bat"
    echo echo üóÑÔ∏è 2. Migrar base de datos: python migrate_system_tables.py >> "%BUILD_FULL_DIR%\INSTALL.bat"
    echo echo üöÄ 3. Ejecutar start_bot.bat >> "%BUILD_FULL_DIR%\INSTALL.bat"
)
echo echo üìö 4. Ver docs\ para gu√≠as completas >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo. >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo echo ========================================== >> "%BUILD_FULL_DIR%\INSTALL.bat"
echo pause >> "%BUILD_FULL_DIR%\INSTALL.bat"

echo ‚úÖ INSTALL.bat creado

:: ===========================================
::   CREAR EJECUTOR PRINCIPAL
:: ===========================================
echo.
echo üöÄ Creando ejecutor principal...

echo @echo off > "%BUILD_FULL_DIR%\start_bot.bat"
echo chcp 65001 ^>nul 2^>^&1 >> "%BUILD_FULL_DIR%\start_bot.bat"
echo title SCUM Bot V2 - Sistema Completo >> "%BUILD_FULL_DIR%\start_bot.bat"
echo color 0A >> "%BUILD_FULL_DIR%\start_bot.bat"
echo. >> "%BUILD_FULL_DIR%\start_bot.bat"
echo cd /d "%%~dp0" >> "%BUILD_FULL_DIR%\start_bot.bat"
echo. >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo ========================================== >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo   SCUM Bot V2 - Iniciando Sistema Completo >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo ========================================== >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo. >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo üìç Directorio: %%CD%% >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo üìÑ Verificando sistema... >> "%BUILD_FULL_DIR%\start_bot.bat"
echo. >> "%BUILD_FULL_DIR%\start_bot.bat"
echo :: Verificar archivos cr√≠ticos >> "%BUILD_FULL_DIR%\start_bot.bat"
echo if not exist "BunkerAdvice_V2.py" ^( >> "%BUILD_FULL_DIR%\start_bot.bat"
echo     color 0C >> "%BUILD_FULL_DIR%\start_bot.bat"
echo     echo ‚ùå ERROR: Sistema incompleto >> "%BUILD_FULL_DIR%\start_bot.bat"
echo     echo    Ejecuta INSTALL.bat primero >> "%BUILD_FULL_DIR%\start_bot.bat"
echo     pause >> "%BUILD_FULL_DIR%\start_bot.bat"
echo     exit /b 1 >> "%BUILD_FULL_DIR%\start_bot.bat"
echo ^) >> "%BUILD_FULL_DIR%\start_bot.bat"
echo. >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo ‚úÖ Sistema verificado - Iniciando bot... >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo. >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo ü§ñ Sistemas activos: >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo    ^üè† Bunkers   ^üöñ Taxi      ^üè¶ Bancario  ^üîß Mec√°nico  ^üèÜ Escuadrones >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo    ^üìä Monitor   ^üíé Premium   ^üîî Alertas   ^‚öôÔ∏è Admin    ^‚ö° RateLimit >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo. >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo ========================================== >> "%BUILD_FULL_DIR%\start_bot.bat"
echo echo. >> "%BUILD_FULL_DIR%\start_bot.bat"
echo python BunkerAdvice_V2.py >> "%BUILD_FULL_DIR%\start_bot.bat"
echo. >> "%BUILD_FULL_DIR%\start_bot.bat"
echo if errorlevel 1 ^( >> "%BUILD_FULL_DIR%\start_bot.bat"
echo     color 0C >> "%BUILD_FULL_DIR%\start_bot.bat"
echo     echo ‚ùå El bot se cerr√≥ inesperadamente >> "%BUILD_FULL_DIR%\start_bot.bat"
echo     echo üìã Revisa los logs en: logs\bot.log >> "%BUILD_FULL_DIR%\start_bot.bat"
echo     echo üõ†Ô∏è Para diagn√≥stico: scripts\install_windows_debug.bat >> "%BUILD_FULL_DIR%\start_bot.bat"
echo ^) >> "%BUILD_FULL_DIR%\start_bot.bat"
echo pause >> "%BUILD_FULL_DIR%\start_bot.bat"

echo ‚úÖ start_bot.bat creado

:: ===========================================
::   CREAR README COMPLETO
:: ===========================================
echo.
echo üìã Creando documentaci√≥n completa...

echo # SCUM Bot V2 - Sistema Completo > "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ## üöÄ Instalaci√≥n R√°pida >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo 1. **Instalar sistema completo:** >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo    ```batch >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo    INSTALL.bat >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo    ``` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
if defined DISCORD_TOKEN_VALUE (
    echo 2. **‚úÖ Token ya configurado autom√°ticamente** >> "%BUILD_FULL_DIR%\README_BUILD.md"
    echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
    echo 3. **Ejecutar bot:** >> "%BUILD_FULL_DIR%\README_BUILD.md"
) else (
    echo 2. **Configurar token:** >> "%BUILD_FULL_DIR%\README_BUILD.md"
    echo    - Editar `config.py` >> "%BUILD_FULL_DIR%\README_BUILD.md"
    echo    - Reemplazar `TU_TOKEN_AQUI` con tu token real >> "%BUILD_FULL_DIR%\README_BUILD.md"
    echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
    echo 3. **Ejecutar bot:** >> "%BUILD_FULL_DIR%\README_BUILD.md"
)
echo    ```batch >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo    start_bot.bat >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo    ``` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ## üéÆ Sistemas Incluidos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### üè† Sistema de Bunkers >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Monitoreo autom√°tico de 4 bunkers SCUM >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Alertas con timezone autom√°tico ^(Uruguay, Argentina, Brasil^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Comandos de administraci√≥n avanzados >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### üöñ Sistema de Taxi >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Sistema completo con 5 tipos de veh√≠culos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Registro de conductores con niveles >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Zonas del mapa con tarifas diferenciadas >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Comisiones autom√°ticas para conductores >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### üè¶ Sistema Bancario >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Cuentas autom√°ticas para usuarios >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Transferencias entre jugadores >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Historial completo de transacciones >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Canje diario optimizado: $500 >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Welcome bonus: $7,500 >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### üîß Sistema de Mec√°nico >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Registro y gesti√≥n de veh√≠culos personales >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Seguros vinculados a veh√≠culos registrados >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - L√≠mites configurables por tipo de veh√≠culo >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Diferenciaci√≥n PVP/PVE con recargo configurable >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Notificaciones DM a mec√°nicos registrados >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - M√©todos de pago: Discord y InGame >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Panel interactivo para gesti√≥n de veh√≠culos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - **NUEVO:** Gesti√≥n de precios con botones interactivos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - **NUEVO:** Selectores visuales para tipos de veh√≠culos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - **NUEVO:** Precios din√°micos que se actualizan autom√°ticamente >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### üõ†Ô∏è Correcciones Cr√≠ticas ^(AGOSTO 2025^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - **RESUELTO:** Error 404 "Unknown interaction" en botones de bunkers >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - **RESUELTO:** Error 400 "Interaction already acknowledged" >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - **MEJORADO:** Arquitectura modular ^(bunkers separados de taxi^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - **A√ëADIDO:** Manejo robusto de errores de Discord >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - **A√ëADIDO:** Tests automatizados para verificar correcciones >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Ver: `docs/BOTONES_CORREGIDOS.md` para detalles t√©cnicos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### üèÜ Sistema de Escuadrones ^(NUEVO^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Creaci√≥n de escuadrones con selector PvP/PvE visual >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Uni√≥n a escuadrones existentes con confirmaci√≥n >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Detecci√≥n autom√°tica de zona basada en membres√≠a >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Gesti√≥n de miembros y l√≠mites personalizables >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Canal dedicado con panel persistente >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Integraci√≥n completa con sistema de seguros >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### üìä Sistema de Monitoreo >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Estado en tiempo real de servidores SCUM >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Top servidores por popularidad >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Estad√≠sticas detalladas de uso >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### üíé Sistema Premium >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Comandos exclusivos para usuarios premium >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Gesti√≥n de suscripciones >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Tienda virtual integrada >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### üîî Sistema de Alertas >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Alertas de reinicio personalizables >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Detecci√≥n autom√°tica de timezone >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Horarios convertidos a zona local >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### ‚öôÔ∏è Sistema de Administraci√≥n >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Panel de control completo >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Configuraci√≥n por servidor >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Herramientas de diagn√≥stico >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### ‚ö° Sistema de Rate Limiting ^(NUEVO^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Control de uso por usuario y servidor >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Cooldowns configurables por comando >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Prevenci√≥n de spam y sobrecarga >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Estad√≠sticas de uso en tiempo real >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Comandos administrativos para gesti√≥n >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo - Pool de conexiones de base de datos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ## üìä Estad√≠sticas del Sistema >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ```yaml >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo Comandos Totales: 60+ >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo Sistemas Integrados: 10 >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo Tipos de Veh√≠culos: 6 ^(Moto, Ranger, Laika, WW, Avion, Barca^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo Zonas del Mapa: 20+ >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo Canales Configurables: 8 ^(incluye Canal de Escuadrones^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo Tipos de Escuadrones: 2 ^(PvP, PvE^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo Detecci√≥n Autom√°tica: ‚úÖ Zona PvP/PvE por escuadr√≥n >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo Compatibilidad: Python 3.13 >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ``` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ## üìÅ Estructura del Build >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ```tree >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ScumBot_Complete/ >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ BunkerAdvice_V2.py          # Bot principal >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ config.py                   # Configuraci√≥n ^(**EDITAR AQU√ç**^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ requirements.txt            # Dependencias Python >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ INSTALL.bat                 # Instalador autom√°tico >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ start_bot.bat               # Ejecutar bot >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ Sistema de Bunkers: >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ database_v2.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îî‚îÄ‚îÄ bot_status_system.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ Sistema de Taxi: >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ taxi_system.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ taxi_database.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ taxi_admin.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ banking_system.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îî‚îÄ‚îÄ welcome_system.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ Sistema de Mec√°nico: >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ mechanic_system.py          # Mec√°nico + Escuadrones >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îî‚îÄ‚îÄ migrate_mechanic_db.py      # Migraci√≥n de BD >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ Sistema Premium: >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ premium_commands.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ premium_exclusive_commands.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ subscription_manager.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îî‚îÄ‚îÄ shop_config.py >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ Sistema Rate Limiting: >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ rate_limiter.py               # Core rate limiting >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ rate_limit_admin.py           # Comandos administrativos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ database_pool.py              # Pool de conexiones DB >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îú‚îÄ‚îÄ test_rate_limiting.py         # Pruebas unitarias >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ   ‚îî‚îÄ‚îÄ test_bot_integration.py       # Pruebas de integraci√≥n >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îÇ >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ docs/                       # Documentaci√≥n completa >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ scripts/                    # Scripts de instalaci√≥n >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ databases/                  # Bases de datos existentes >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îú‚îÄ‚îÄ logs/                       # Archivos de registro >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ‚îî‚îÄ‚îÄ backup/                     # Respaldos autom√°ticos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ``` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ## üõ†Ô∏è Resoluci√≥n de Problemas >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### Error de instalaci√≥n >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ```batch >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo scripts\install_windows_debug.bat >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ``` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### Bot se cierra inesperadamente >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo 1. Revisa `logs\bot.log` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo 2. Verifica token en `config.py` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo 3. Ejecuta diagn√≥stico: `debug_user.py` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### Base de datos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ```python >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo python check_db.py              # Verificar base de datos >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo python migrate_taxi_db.py       # Migrar datos de taxi >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo python migrate_mechanic_db.py   # Migrar sistema de mec√°nico >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo python test_rate_limiting.py    # Probar sistema de rate limiting >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo python test_bot_integration.py  # Verificar integraci√≥n completa >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ``` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ### Tests de Correcciones Cr√≠ticas ^(NUEVO^) >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ```python >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo python test_button_fixes.py     # Verificar correcciones de botones >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo python test_architecture_fix.py # Verificar arquitectura modular >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo ``` >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo **Estos tests verifican que las correcciones cr√≠ticas funcionan correctamente** >> "%BUILD_FULL_DIR%\README_BUILD.md"
echo. >> "%BUILD_FULL_DIR%\README_BUILD.md"

echo ‚úÖ README_BUILD.md creado

:: ===========================================
::   CREAR GITIGNORE
:: ===========================================
echo.
echo üìÑ Creando .gitignore...

echo # Configuraci√≥n > "%BUILD_FULL_DIR%\.gitignore"
echo config.py >> "%BUILD_FULL_DIR%\.gitignore"
echo .env >> "%BUILD_FULL_DIR%\.gitignore"
echo. >> "%BUILD_FULL_DIR%\.gitignore"
echo # Base de datos >> "%BUILD_FULL_DIR%\.gitignore"
echo *.db >> "%BUILD_FULL_DIR%\.gitignore"
echo *.db-journal >> "%BUILD_FULL_DIR%\.gitignore"
echo backup/*.db >> "%BUILD_FULL_DIR%\.gitignore"
echo. >> "%BUILD_FULL_DIR%\.gitignore"
echo # Logs >> "%BUILD_FULL_DIR%\.gitignore"
echo logs/*.log >> "%BUILD_FULL_DIR%\.gitignore"
echo *.log >> "%BUILD_FULL_DIR%\.gitignore"
echo. >> "%BUILD_FULL_DIR%\.gitignore"
echo # Python >> "%BUILD_FULL_DIR%\.gitignore"
echo __pycache__/ >> "%BUILD_FULL_DIR%\.gitignore"
echo *.pyc >> "%BUILD_FULL_DIR%\.gitignore"
echo *.pyo >> "%BUILD_FULL_DIR%\.gitignore"
echo .pytest_cache/ >> "%BUILD_FULL_DIR%\.gitignore"

echo ‚úÖ .gitignore creado

:: ===========================================
::   RESUMEN FINAL
:: ===========================================
echo.
echo ===============================================
echo   üéâ BUILD COMPLETO GENERADO EXITOSAMENTE
echo ===============================================
echo.
echo üìÅ Ubicaci√≥n: %BUILD_FULL_DIR%
echo üìä Timestamp: %BUILD_TIMESTAMP%
echo.
echo üéÆ SISTEMA COMPLETO INCLUIDO:
echo    üè† Bunkers         üìä Monitor      üíé Premium     üîî Alertas
echo    üöñ Taxi           üè¶ Bancario     üîß Mec√°nico    üèÜ Escuadrones
echo    ‚öôÔ∏è Admin          ‚ö° RateLimit
echo.
echo üìä ESTAD√çSTICAS DEL BUILD:
echo    ‚úÖ 60+ comandos de Discord funcionales
echo    ‚úÖ 10 sistemas completamente integrados
echo    ‚úÖ 25+ archivos Python principales
echo    ‚úÖ Documentaci√≥n completa incluida
echo    ‚úÖ Scripts de instalaci√≥n autom√°tica
echo    ‚úÖ Compatible con Python 3.13
echo    ‚úÖ Sistema de escuadrones con detecci√≥n autom√°tica
echo    ‚úÖ Gesti√≥n de precios con interfaz interactiva
echo    ‚úÖ **NUEVO:** Errores cr√≠ticos de botones resueltos
echo    ‚úÖ **NUEVO:** Arquitectura modular corregida
echo.
if defined DISCORD_TOKEN_VALUE (
    echo üîë Token: ‚úÖ Configurado autom√°ticamente
) else (
    echo üîë Token: ‚ö†Ô∏è Requiere configuraci√≥n manual en config.py
)
echo.
echo üìã CONTENIDO PRINCIPAL:
dir "%BUILD_FULL_DIR%" /B | findstr /V "logs backup config scripts docs"
echo.
echo üìÅ Carpetas incluidas:
echo    - docs/       (documentaci√≥n completa)
echo    - scripts/    (instaladores avanzados)
echo    - logs/       (archivos de registro)
echo    - backup/     (respaldos autom√°ticos)
echo    - config/     (configuraciones adicionales)
echo.
echo ===============================================
echo   üì¶ LISTO PARA DESPLIEGUE COMPLETO
echo ===============================================
echo.
echo üöÄ PARA USAR EN CUALQUIER SERVIDOR:
echo.
echo 1Ô∏è‚É£ Copiar carpeta completa: %BUILD_FULL_DIR%
echo 2Ô∏è‚É£ En el servidor destino ejecutar: INSTALL.bat
if defined DISCORD_TOKEN_VALUE (
    echo 3Ô∏è‚É£ ‚úÖ Token ya configurado - Listo para usar
    echo 4Ô∏è‚É£ Ejecutar directamente: start_bot.bat
) else (
    echo 3Ô∏è‚É£ Configurar token en config.py
    echo 4Ô∏è‚É£ Ejecutar: start_bot.bat
)
echo 5Ô∏è‚É£ Ver docs\ para configuraci√≥n avanzada
echo.
echo üéØ CARACTER√çSTICAS √öNICAS:
echo    ‚úÖ Sistema econ√≥mico balanceado para progresi√≥n r√°pida
echo    ‚úÖ Timezone autom√°tico para Uruguay/Argentina/Brasil
echo    ‚úÖ Interfaz con botones interactivos persistentes
echo    ‚úÖ Multi-servidor con configuraci√≥n independiente
echo    ‚úÖ Sistema de niveles para conductores de taxi
echo    ‚úÖ Registro y gesti√≥n personal de veh√≠culos
echo    ‚úÖ Seguros vehiculares vinculados a veh√≠culos registrados
echo    ‚úÖ L√≠mites configurables por tipo de veh√≠culo
echo    ‚úÖ Diferenciaci√≥n PVP/PVE con recargos personalizables
echo    ‚úÖ Sistema de escuadrones con creaci√≥n y uni√≥n autom√°tica
echo    ‚úÖ Detecci√≥n autom√°tica de zona por membres√≠a de escuadr√≥n
echo    ‚úÖ Gesti√≥n de precios con interfaz interactiva ^(botones + selectores^)
echo    ‚úÖ 6 tipos de veh√≠culos soportados ^(eliminado hydroavion^)
echo    ‚úÖ Paneles que se limpian y recrean autom√°ticamente
echo    ‚úÖ Monitoreo en tiempo real de servidores SCUM
echo    ‚úÖ Sistema premium con tienda virtual integrada
echo    ‚úÖ Rate limiting avanzado con cooldowns configurables
echo    ‚úÖ Pool de conexiones de base de datos para mejor rendimiento
echo    ‚úÖ Comandos administrativos para gesti√≥n de l√≠mites
echo    ‚úÖ Estad√≠sticas de uso en tiempo real
echo    ‚úÖ Prevenci√≥n autom√°tica de spam y sobrecarga
echo    ‚úÖ **NUEVO:** Correcciones cr√≠ticas de interacciones de botones
echo    ‚úÖ **NUEVO:** Arquitectura modular mejorada ^(bunkers separados^)
echo    ‚úÖ **NUEVO:** Manejo robusto de errores Discord ^(404/400 resueltos^)
echo    ‚úÖ **NUEVO:** Tests automatizados para verificar correcciones
echo.
echo ===============================================
echo.

color 0A
pause